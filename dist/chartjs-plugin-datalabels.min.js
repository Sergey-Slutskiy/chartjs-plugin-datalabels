/*!
 * chartjs-plugin-datalabels v0.7.0
 * https://chartjs-plugin-datalabels.netlify.com
 * (c) 2020 Chart.js Contributors
 * Released under the MIT license
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("chart.js")):"function"==typeof define&&define.amd?define(["chart.js"],e):(t=t||self).ChartDataLabels=e(t.Chart)}(this,(function(t){"use strict";var e=(t=t&&t.hasOwnProperty("default")?t.default:t).helpers,n=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t)return(t.deviceXDPI||1)/(t.logicalXDPI||1)}return 1}(),o={toTextLines:function(t){var n,o=[];for(t=[].concat(t);t.length;)"string"==typeof(n=t.pop())?o.unshift.apply(o,n.split("\n")):Array.isArray(n)?t.push.apply(t,n):e.isNullOrUndef(t)||o.unshift(""+n);return o},toFontString:function(t){return!t||e.isNullOrUndef(t.size)||e.isNullOrUndef(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family},textSize:function(t,e,n){var o,r=[].concat(e),a=r.length,i=t.font,l=0;for(t.font=n.string,o=0;o<a;++o)l=Math.max(t.measureText(r[o]).width,l);return t.font=i,{height:a*n.lineHeight,width:l}},parseFont:function(n){var r=t.defaults.global,a=e.valueOrDefault(n.size,r.defaultFontSize),i={family:e.valueOrDefault(n.family,r.defaultFontFamily),lineHeight:e.options.toLineHeight(n.lineHeight,a),size:a,style:e.valueOrDefault(n.style,r.defaultFontStyle),weight:e.valueOrDefault(n.weight,null),string:""};return i.string=o.toFontString(i),i},bound:function(t,e,n){return Math.max(t,Math.min(e,n))},arrayDiff:function(t,e){var n,o,r,a,i=t.slice(),l=[];for(n=0,r=e.length;n<r;++n)a=e[n],-1===(o=i.indexOf(a))?l.push([a,1]):i.splice(o,1);for(n=0,r=i.length;n<r;++n)l.push([i[n],-1]);return l},rasterize:function(t){return Math.round(t*n)/n}};function r(t,e){var n=e.x,o=e.y;if(null===n)return{x:0,y:-1};if(null===o)return{x:1,y:0};var r=t.x-n,a=t.y-o,i=Math.sqrt(r*r+a*a);return{x:i?r/i:0,y:i?a/i:-1}}function a(t,e,n){var o=0;return t<n.left?o|=1:t>n.right&&(o|=2),e<n.top?o|=8:e>n.bottom&&(o|=4),o}function i(t,e){var n,o,r=e.anchor,i=t;return e.clamp&&(i=function(t,e){for(var n,o,r,i=t.x0,l=t.y0,s=t.x1,u=t.y1,d=a(i,l,e),c=a(s,u,e);d|c&&!(d&c);)8&(n=d||c)?(o=i+(s-i)*(e.top-l)/(u-l),r=e.top):4&n?(o=i+(s-i)*(e.bottom-l)/(u-l),r=e.bottom):2&n?(r=l+(u-l)*(e.right-i)/(s-i),o=e.right):1&n&&(r=l+(u-l)*(e.left-i)/(s-i),o=e.left),n===d?d=a(i=o,l=r,e):c=a(s=o,u=r,e);return{x0:i,x1:s,y0:l,y1:u}}(i,e.area)),"start"===r?(n=i.x0,o=i.y0):"end"===r?(n=i.x1,o=i.y1):(n=(i.x0+i.x1)/2,o=(i.y0+i.y1)/2),function(t,e,n,o,r){switch(r){case"center":n=o=0;break;case"bottom":n=0,o=1;break;case"right":n=1,o=0;break;case"left":n=-1,o=0;break;case"top":n=0,o=-1;break;case"start":n=-n,o=-o;break;case"end":break;default:r*=Math.PI/180,n=Math.cos(r),o=Math.sin(r)}return{x:t,y:e,vx:n,vy:o}}(n,o,t.vx,t.vy,e.align)}var l=function(t,e){var n=(t.startAngle+t.endAngle)/2,o=Math.cos(n),r=Math.sin(n),a=t.innerRadius,l=t.outerRadius;return i({x0:t.x+o*a,y0:t.y+r*a,x1:t.x+o*l,y1:t.y+r*l,vx:o,vy:r},e)},s=function(t,e){var n=r(t,e.origin),o=n.x*t.radius,a=n.y*t.radius;return i({x0:t.x-o,y0:t.y-a,x1:t.x+o,y1:t.y+a,vx:n.x,vy:n.y},e)},u=function(t,e){var n=r(t,e.origin),o=t.x,a=t.y,l=0,s=0;return t.horizontal?(o=Math.min(t.x,t.base),l=Math.abs(t.base-t.x)):(a=Math.min(t.y,t.base),s=Math.abs(t.base-t.y)),i({x0:o,y0:a+s,x1:o+l,y1:a,vx:n.x,vy:n.y},e)},d=function(t,e){var n=r(t,e.origin);return i({x0:t.x,y0:t.y,x1:t.x,y1:t.y,vx:n.x,vy:n.y},e)},c=t.helpers,f=o.rasterize;function h(t){var e=t._model.horizontal,n=t._scale||e&&t._xScale||t._yScale;if(!n)return null;if(void 0!==n.xCenter&&void 0!==n.yCenter)return{x:n.xCenter,y:n.yCenter};var o=n.getBasePixel();return e?{x:o,y:null}:{x:null,y:o}}function x(t,e,n){var o=n.backgroundColor,r=n.borderColor,a=n.borderWidth;(o||r&&a)&&(t.beginPath(),c.canvas.roundedRect(t,f(e.x)+a/2,f(e.y)+a/2,f(e.w)-a,f(e.h)-a,n.borderRadius),n.hexagon&&function(t,e,n){let o=f(1.8*e.x)+n/2,r=f(2*e.y)+n/2,a=e.w,i=Math.sin(.523598776)*a,l=Math.cos(.523598776)*a,s=a+2*i,u=2*l;console.log("x",o),console.log("y",r),console.log("sideLength",a),console.log("hexHeight",i),console.log("hexRadius",l),console.log("hexRectangleHeight",s),console.log("hexRectangleWidth",u),console.log("moveTo",o+l,r),console.log("lineTo 1 ",o+u,r+i),console.log("lineTo 2",o+u,r+i+a),console.log("lineTo 3",o+l,r+s),console.log("lineTo 4",o,r+a+i),console.log("lineTo 5",o,r+i),t.beginPath(),t.moveTo(o+l,r),t.lineTo(o+u,r+i),t.lineTo(o+u,r+i+a),t.lineTo(o+l,r+s),t.lineTo(o,r+a+i),t.lineTo(o,r+i),t.closePath()}(t,e,a),t.closePath(),o&&(t.fillStyle=o,t.fill()),r&&a&&(t.strokeStyle=r,t.lineWidth=a,t.lineJoin="miter",t.stroke()))}function y(t,e,n){var o=t.shadowBlur,r=n.stroked,a=f(n.x),i=f(n.y),l=f(n.w);r&&t.strokeText(e,a,i,l),n.filled&&(o&&r&&(t.shadowBlur=0),t.fillText(e,a,i,l),o&&r&&(t.shadowBlur=o))}var v=function(t,e,n,o){var r=this;r._config=t,r._index=o,r._model=null,r._rects=null,r._ctx=e,r._el=n};c.extend(v.prototype,{_modelize:function(e,n,r,a){var i,f=this._index,x=c.options.resolve,y=o.parseFont(x([r.font,{}],a,f)),v=x([r.color,t.defaults.global.defaultFontColor],a,f);return{align:x([r.align,"center"],a,f),anchor:x([r.anchor,"center"],a,f),area:a.chart.chartArea,backgroundColor:x([r.backgroundColor,null],a,f),borderColor:x([r.borderColor,null],a,f),borderRadius:x([r.borderRadius,0],a,f),borderWidth:x([r.borderWidth,0],a,f),clamp:x([r.clamp,!1],a,f),clip:x([r.clip,!1],a,f),color:v,display:e,font:y,lines:n,offset:x([r.offset,0],a,f),opacity:x([r.opacity,1],a,f),origin:h(this._el),padding:c.options.toPadding(x([r.padding,0],a,f)),positioner:(i=this._el,i instanceof t.elements.Arc?l:i instanceof t.elements.Point?s:i instanceof t.elements.Rectangle?u:d),rotation:x([r.rotation,0],a,f)*(Math.PI/180),size:o.textSize(this._ctx,n,y),textAlign:x([r.textAlign,"start"],a,f),textShadowBlur:x([r.textShadowBlur,0],a,f),textShadowColor:x([r.textShadowColor,v],a,f),textStrokeColor:x([r.textStrokeColor,v],a,f),textStrokeWidth:x([r.textStrokeWidth,0],a,f),hexagon:x([r.hexagon,!1],a,f)}},update:function(t){var e,n,r,a=this,i=null,l=null,s=a._index,u=a._config,d=c.options.resolve([u.display,!0],t,s);d&&(e=t.dataset.data[s],n=c.valueOrDefault(c.callback(u.formatter,[e,t]),e),(r=c.isNullOrUndef(n)?[]:o.toTextLines(n)).length&&(l=function(t){var e=t.borderWidth||0,n=t.padding,o=t.size.height,r=t.size.width,a=-r/2,i=-o/2;return{frame:{x:a-n.left-e,y:i-n.top-e,w:r+n.width+2*e,h:o+n.height+2*e},text:{x:a,y:i,w:r,h:o}}}(i=a._modelize(d,r,u,t)))),a._model=i,a._rects=l},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(t,e){var n,r=t.ctx,a=this._model,i=this._rects;this.visible()&&(r.save(),a.clip&&(n=a.area,r.beginPath(),r.rect(n.left,n.top,n.right-n.left,n.bottom-n.top),r.clip()),r.globalAlpha=o.bound(0,a.opacity,1),r.translate(f(e.x),f(e.y)),r.rotate(a.rotation),x(r,i.frame,a),function(t,e,n,o){var r,a=o.textAlign,i=o.color,l=!!i,s=o.font,u=e.length,d=o.textStrokeColor,c=o.textStrokeWidth,f=d&&c;if(u&&(l||f))for(n=function(t,e,n){var o=n.lineHeight,r=t.w,a=t.x;return"center"===e?a+=r/2:"end"!==e&&"right"!==e||(a+=r),{h:o,w:r,x:a,y:t.y+o/2}}(n,a,s),t.font=s.string,t.textAlign=a,t.textBaseline="middle",t.shadowBlur=o.textShadowBlur,t.shadowColor=o.textShadowColor,l&&(t.fillStyle=i),f&&(t.lineJoin="round",t.lineWidth=c,t.strokeStyle=d),r=0,u=e.length;r<u;++r)y(t,e[r],{stroked:f,filled:l,w:n.w,x:n.x,y:n.y+n.h*r})}(r,a.lines,i.text,a),r.restore())}});var g=t.helpers,b=Number.MIN_SAFE_INTEGER||-9007199254740991,_=Number.MAX_SAFE_INTEGER||9007199254740991;function p(t,e,n){var o=Math.cos(n),r=Math.sin(n),a=e.x,i=e.y;return{x:a+o*(t.x-a)-r*(t.y-i),y:i+r*(t.x-a)+o*(t.y-i)}}function m(t,e){var n,o,r,a,i,l=_,s=b,u=e.origin;for(n=0;n<t.length;++n)r=(o=t[n]).x-u.x,a=o.y-u.y,i=e.vx*r+e.vy*a,l=Math.min(l,i),s=Math.max(s,i);return{min:l,max:s}}function w(t,e){var n=e.x-t.x,o=e.y-t.y,r=Math.sqrt(n*n+o*o);return{vx:(e.x-t.x)/r,vy:(e.y-t.y)/r,origin:t,ln:r}}var k=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function M(t,e,n){var o=e.positioner(t,e),r=o.vx,a=o.vy;if(!r&&!a)return{x:o.x,y:o.y};var i=n.w,l=n.h,s=e.rotation,u=Math.abs(i/2*Math.cos(s))+Math.abs(l/2*Math.sin(s)),d=Math.abs(i/2*Math.sin(s))+Math.abs(l/2*Math.cos(s)),c=1/Math.max(Math.abs(r),Math.abs(a));return u*=r*c,d*=a*c,u+=e.offset*r,d+=e.offset*a,{x:o.x+u,y:o.y+d}}g.extend(k.prototype,{center:function(){var t=this._rect;return{x:t.x+t.w/2,y:t.y+t.h/2}},update:function(t,e,n){this._rotation=n,this._rect={x:e.x+t.x,y:e.y+t.y,w:e.w,h:e.h}},contains:function(t){var e=this._rect;return!((t=p(t,this.center(),-this._rotation)).x<e.x-1||t.y<e.y-1||t.x>e.x+e.w+2||t.y>e.y+e.h+2)},intersects:function(t){var e,n,o,r=this._points(),a=t._points(),i=[w(r[0],r[1]),w(r[0],r[3])];for(this._rotation!==t._rotation&&i.push(w(a[0],a[1]),w(a[0],a[3])),e=0;e<i.length;++e)if(n=m(r,i[e]),o=m(a,i[e]),n.max<o.min||o.max<n.min)return!1;return!0},_points:function(){var t=this._rect,e=this._rotation,n=this.center();return[p({x:t.x,y:t.y},n,e),p({x:t.x+t.w,y:t.y},n,e),p({x:t.x+t.w,y:t.y+t.h},n,e),p({x:t.x,y:t.y+t.h},n,e)]}});var $={prepare:function(t){var e,n,o,r,a,i=[];for(e=0,o=t.length;e<o;++e)for(n=0,r=t[e].length;n<r;++n)a=t[e][n],i.push(a),a.$layout={_box:new k,_hidable:!1,_visible:!0,_set:e,_idx:n};return i.sort((function(t,e){var n=t.$layout,o=e.$layout;return n._idx===o._idx?o._set-n._set:o._idx-n._idx})),this.update(i),i},update:function(t){var e,n,o,r,a,i=!1;for(e=0,n=t.length;e<n;++e)r=(o=t[e]).model(),(a=o.$layout)._hidable=r&&"auto"===r.display,a._visible=o.visible(),i|=a._hidable;i&&function(t){var e,n,o,r,a,i;for(e=0,n=t.length;e<n;++e)(r=(o=t[e]).$layout)._visible&&(a=o.geometry(),i=M(o._el._model,o.model(),a),r._box.update(i,a,o.rotation()));(function(t,e){var n,o,r,a;for(n=t.length-1;n>=0;--n)for(r=t[n].$layout,o=n-1;o>=0&&r._visible;--o)(a=t[o].$layout)._visible&&r._box.intersects(a._box)&&e(r,a)})(t,(function(t,e){var n=t._hidable,o=e._hidable;n&&o||o?e._visible=!1:n&&(t._visible=!1)}))}(t)},lookup:function(t,e){var n,o;for(n=t.length-1;n>=0;--n)if((o=t[n].$layout)&&o._visible&&o._box.contains(e))return t[n];return null},draw:function(t,e){var n,o,r,a,i,l;for(n=0,o=e.length;n<o;++n)(a=(r=e[n]).$layout)._visible&&(i=r.geometry(),l=M(r._el._view,r.model(),i),a._box.update(l,i,r.rotation()),r.draw(t,l))}},S=t.helpers,C={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(t){if(S.isNullOrUndef(t))return null;var e,n,o,r=t;if(S.isObject(t))if(S.isNullOrUndef(t.label))if(S.isNullOrUndef(t.r))for(r="",o=0,n=(e=Object.keys(t)).length;o<n;++o)r+=(0!==o?", ":"")+e[o]+": "+t[e[o]];else r=t.r;else r=t.label;return""+r},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},T=t.helpers;function z(t,e,n){if(e){var o,r=n.$context,a=n.$groups;e[a._set]&&(o=e[a._set][a._key])&&!0===T.callback(o,[r])&&(t.$datalabels._dirty=!0,n.update(r))}}function O(t,e){var n,o,r=t.$datalabels,a=r._listeners;if(a.enter||a.leave){if("mousemove"===e.type)o=$.lookup(r._labels,e);else if("mouseout"!==e.type)return;n=r._hovered,r._hovered=o,function(t,e,n,o){var r,a;(n||o)&&(n?o?n!==o&&(a=r=!0):a=!0:r=!0,a&&z(t,e.leave,n),r&&z(t,e.enter,o))}(t,a,n,o)}}t.defaults.global.plugins.datalabels=C;var A={id:"datalabels",beforeInit:function(t){t.$datalabels={_actives:[]}},beforeUpdate:function(t){var e=t.$datalabels;e._listened=!1,e._listeners={},e._datasets=[],e._labels=[]},afterDatasetUpdate:function(t,e,n){var o,r,a,i,l,s,u,d,c=e.index,f=t.$datalabels,h=f._datasets[c]=[],x=t.isDatasetVisible(c),y=t.data.datasets[c],g=function(t,e){var n,o,r,a=t.datalabels,i=[];return!1===a?null:(!0===a&&(a={}),e=T.merge({},[e,a]),o=e.labels||{},r=Object.keys(o),delete e.labels,r.length?r.forEach((function(t){o[t]&&i.push(T.merge({},[e,o[t],{_key:t}]))})):i.push(e),n=i.reduce((function(t,e){return T.each(e.listeners||{},(function(n,o){t[o]=t[o]||{},t[o][e._key||"$default"]=n})),delete e.listeners,t}),{}),{labels:i,listeners:n})}(y,n),b=e.meta.data||[],_=t.ctx;for(_.save(),o=0,a=b.length;o<a;++o)if((u=b[o]).$datalabels=[],x&&u&&!u.hidden&&!u._model.skip)for(r=0,i=g.labels.length;r<i;++r)s=(l=g.labels[r])._key,(d=new v(l,_,u,o)).$groups={_set:c,_key:s||"$default"},d.$context={active:!1,chart:t,dataIndex:o,dataset:y,datasetIndex:c},d.update(d.$context),u.$datalabels.push(d),h.push(d);_.restore(),T.merge(f._listeners,g.listeners,{merger:function(t,n,o){n[t]=n[t]||{},n[t][e.index]=o[t],f._listened=!0}})},afterUpdate:function(t,e){t.$datalabels._labels=$.prepare(t.$datalabels._datasets,e)},afterDatasetsDraw:function(t){$.draw(t,t.$datalabels._labels)},beforeEvent:function(t,e){if(t.$datalabels._listened)switch(e.type){case"mousemove":case"mouseout":O(t,e);break;case"click":!function(t,e){var n=t.$datalabels,o=n._listeners.click,r=o&&$.lookup(n._labels,e);r&&z(t,o,r)}(t,e)}},afterEvent:function(e){var n,r,a,i,l,s,u,d=e.$datalabels,c=d._actives,f=d._actives=e.lastActive||[],h=o.arrayDiff(c,f);for(n=0,r=h.length;n<r;++n)if((l=h[n])[1])for(a=0,i=(u=l[0].$datalabels||[]).length;a<i;++a)(s=u[a]).$context.active=1===l[1],s.update(s.$context);(d._dirty||h.length)&&($.update(d._labels),function(e){if(!e.animating){for(var n=t.animationService.animations,o=0,r=n.length;o<r;++o)if(n[o].chart===e)return;e.render({duration:1,lazy:!0})}}(e)),delete d._dirty}};return t.plugins.register(A),A}));
